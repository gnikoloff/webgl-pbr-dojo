var _t=Object.defineProperty;var pt=(t,e,i)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var r=(t,e,i)=>(pt(t,typeof e!="symbol"?e+"":e,i),i);import{f as B,c as H,s as nt,n as ot,p as ft,o as xt,a as it,b as F,u as Et,m as ht,d as ct,i as dt,t as Mt,l as vt,e as K,g as wt,h as gt,r as yt,j as Dt,k as St,q as At,A as It}from"./vendor.032aa3bc.js";var bt=Object.defineProperty,Tt=(t,e,i)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,U=(t,e,i)=>(Tt(t,typeof e!="symbol"?e+"":e,i),i),ut=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},f=(t,e,i)=>(ut(t,e,"read from private field"),i?i.call(t):e.get(t)),z=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},Ot=(t,e,i,a)=>(ut(t,e,"write to private field"),a?a.call(t,i):e.set(t,i),i),Z="-- DEFINES_HOOK --",Rt=(t,e,i,a={})=>{if(Object.keys(a).length&&!i.includes(Z))throw new Error(`in order to include defines, you must provide "${Z}" in your shader code`);let s="";for(const[h,u]of Object.entries(a)){if(typeof u=="boolean"&&!u)continue;let _=`${u}`;typeof u=="number"&&Number.isInteger(u)&&(_+=".0"),s+=`#define ${h} ${_}
`}i=i.replace(Z,s);const n=t.createShader(e);if(t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))return n;const o=`
    Error in ${e===t.VERTEX_SHADER?"Vertex":"Fragment"} shader:
    ${t.getShaderInfoLog(n)}
  `;throw t.deleteShader(n),new Error(o)},st=Rt,Ut=(t,e,i,a)=>{const s=st(t,t.VERTEX_SHADER,e,a),n=st(t,t.FRAGMENT_SHADER,i,a),o=t.createProgram();if(t.attachShader(o,s),t.attachShader(o,n),t.linkProgram(o),t.detachShader(o,s),t.deleteShader(s),t.detachShader(o,n),t.deleteShader(n),t.getProgramParameter(o,t.LINK_STATUS))return o;const h=new Error(`Error linking program: ${t.getProgramInfoLog(o)}`);throw t.deleteProgram(o),h},Ht=Ut,Pt=(t,e,i,a)=>{const s=t.getUniformBlockIndex(e,i),n=t.getActiveUniformBlockParameter(e,s,t.UNIFORM_BLOCK_DATA_SIZE),o=t.getActiveUniformBlockParameter(e,s,t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),h=t.getActiveUniformBlockParameter(e,s,t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),u=t.getUniformIndices(e,a),_=t.getActiveUniforms(e,u,t.UNIFORM_OFFSET),M=t.getActiveUniforms(e,u,t.UNIFORM_SIZE),p={};for(let l=0;l<a.length;l++){const d=a[l],v={index:u[l],offset:_[l],size:M[l]};p[d]=v}return{blockIndex:s,blockSize:n,usedInVertexShader:o,usedInFragmentShader:h,uniforms:p}},qt=Pt,Ft=(t,e,i=0,a=t.DYNAMIC_DRAW)=>{const s=t.createBuffer();return t.bindBuffer(t.UNIFORM_BUFFER,s),t.bufferData(t.UNIFORM_BUFFER,e,a),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,i,s),s},Kt=Ft,Nt=(t,e,i,a)=>{let s;switch(e){case t.FLOAT:return t.uniform1f(i,a);case t.FLOAT_VEC2:return s=a,t.uniform2f(i,s[0],s[1]);case t.FLOAT_VEC3:return s=a,t.uniform3f(i,s[0],s[1],s[2]);case t.FLOAT_VEC4:return s=a,t.uniform4f(i,s[0],s[1],s[2],s[3]);case t.BOOL:case t.INT:case t.SAMPLER_2D:case t.SAMPLER_CUBE:return t.uniform1i(i,a);case t.BOOL_VEC2:case t.INT_VEC2:return s=a,t.uniform2i(i,s[0],s[1]);case t.BOOL_VEC3:case t.INT_VEC3:return s=a,t.uniform3i(i,s[0],s[1],s[2]);case t.BOOL_VEC4:case t.INT_VEC4:return s=a,t.uniform4i(i,s[0],s[1],s[2],s[3]);case t.FLOAT_MAT2:return t.uniformMatrix2fv(i,!1,a);case t.FLOAT_MAT3:return t.uniformMatrix3fv(i,!1,a);case t.FLOAT_MAT4:return t.uniformMatrix4fv(i,!1,a);default:throw new Error("wrong type for uniform")}},rt=Nt,Lt=(t={})=>{const{radius:e=.5,widthSegments:i=16,heightSegments:a=Math.ceil(i*.5),phiStart:s=0,phiLength:n=Math.PI*2,thetaStart:o=0,thetaLength:h=Math.PI}=t,u=i,_=a,M=s,p=n,l=o,d=h,v=(u+1)*(_+1),I=u*_*6,w=3+3+2,y=new Float32Array(v*w),S=v>65536?new Uint32Array(I):new Uint16Array(I);let D=0,b=0,m=0;const q=l+d,x=[],T=H();for(let E=0;E<=_;E++){const g=[],O=E/_;for(let A=0;A<=u;A++,D++){const Y=A/u,W=-e*Math.cos(M+Y*p)*Math.sin(l+O*d),tt=e*Math.cos(l+O*d),et=e*Math.sin(M+Y*p)*Math.sin(l+O*d);y[D*w+0]=W,y[D*w+1]=tt,y[D*w+2]=et,nt(T,W,tt,et),ot(T,T),y[D*w+3]=T[0],y[D*w+4]=T[1],y[D*w+5]=T[2],y[D*w+6]=Y,y[D*w+7]=1-O,g.push(b++)}x.push(g)}for(let E=0;E<_;E++)for(let g=0;g<u;g++){const O=x[E][g+1],A=x[E][g],Y=x[E+1][g],W=x[E+1][g+1];(E!==0||l>0)&&(S[m*3]=O,S[m*3+1]=A,S[m*3+2]=W,m++),(E!==_-1||q<Math.PI)&&(S[m*3]=A,S[m*3+1]=Y,S[m*3+2]=W,m++)}return{radius:e,vertexCount:I,vertexStride:w,interleavedArray:y,indicesArray:S}},Zt=Lt,Ct=(t={})=>{const{width:e=1,height:i=1,widthSegments:a=1,heightSegments:s=1,flipUVy:n=!1}=t,o=a,h=s,u=(o+1)*(h+1),_=o*h*6,M=new Float32Array(u*3+u*2),p=u>65536?new Uint32Array(_):new Uint16Array(_);let l=0,d=0;const v=l,I=e/o,w=i/h,y=1,S=-1,D=0,b=3+2;for(let m=0;m<=h;m++){const q=m*w-i/2;for(let x=0;x<=o;x++,l++){const T=x*I-e/2;if(M[l*b+0]=T*y,M[l*b+1]=q*S,M[l*b+2]=D/2,M[l*b+3]=x/o,M[l*b+4]=n?1-m/h:m/h,m===h||x===o)continue;const E=v+x+m*(o+1),g=v+x+(m+1)*(o+1),O=v+x+(m+1)*(o+1)+1,A=v+x+m*(o+1)+1;p[d*6]=E,p[d*6+1]=g,p[d*6+2]=A,p[d*6+3]=g,p[d*6+4]=O,p[d*6+5]=A,d++}}return{width:e,height:i,vertexCount:p.length,vertexStride:b,interleavedArray:M,indicesArray:p}},Gt=Ct,at=(t,e,i)=>Math.min(Math.max(t,e),i),lt=class{constructor(){r(this,"position",B(1,2,3));r(this,"lookAt",B(0,0,0));r(this,"projectionMatrix",F());r(this,"viewMatrix",F());r(this,"viewMatrixInverse",F());r(this,"projectionViewMatrix",F())}updateViewMatrix(){return vt(this.viewMatrix,this.position,this.lookAt,lt.UP_VECTOR),dt(this.viewMatrixInverse,this.viewMatrix),this}updateProjectionViewMatrix(){return ht(this.projectionViewMatrix,this.projectionMatrix,this.viewMatrix),this}},k=lt;U(k,"UP_VECTOR",B(0,1,0));var jt=class extends k{constructor(t,e,i,a){super();r(this,"fieldOfView");r(this,"aspect");r(this,"near");r(this,"far");this.fieldOfView=t,this.aspect=e,this.near=i,this.far=a,this.updateProjectionMatrix()}updateProjectionMatrix(){return ft(this.projectionMatrix,this.fieldOfView,this.aspect,this.near,this.far),this}},Qt=class extends k{constructor(t,e,i,a,s,n){super();r(this,"left");r(this,"right");r(this,"bottom");r(this,"top");r(this,"near");r(this,"far");this.left=t,this.right=e,this.top=i,this.bottom=a,this.near=s,this.far=n,this.updateProjectionMatrix()}updateProjectionMatrix(){return xt(this.projectionMatrix,this.left,this.right,this.bottom,this.top,this.near,this.far),this}},N=class{constructor(){r(this,"value",0);r(this,"damping");this.damping=.5}addForce(t){this.value+=t}update(){return this.value*this.value>1e-6?this.value*=this.damping:this.stop(),this.value}stop(){this.value=0}},Jt=class{constructor(t,e=document.body,i=!1,a=1){r(this,"camera");r(this,"domElement");r(this,"target",H());r(this,"minDistance",0);r(this,"maxDistance",1/0);r(this,"isEnabled",!0);r(this,"isDamping");r(this,"dampingFactor");r(this,"isZoom");r(this,"zoomSpeed");r(this,"isRotate");r(this,"rotateSpeed");r(this,"isPan");r(this,"keyPanSpeed");r(this,"enableKeys");r(this,"keys");r(this,"originTarget");r(this,"originPosition");r(this,"targetXDampedAction",new N);r(this,"targetYDampedAction",new N);r(this,"targetZDampedAction",new N);r(this,"targetThetaDampedAction",new N);r(this,"targetPhiDampedAction",new N);r(this,"targetRadiusDampedAction",new N);r(this,"_isShiftDown",!1);r(this,"_rotateStart",{x:9999,y:9999});r(this,"_rotateEnd",{x:9999,y:9999});r(this,"_roatteDelta",{x:9999,y:9999});r(this,"_spherical");r(this,"_zoomDistanceEnd",0);r(this,"_zoomDistance",0);r(this,"state","");r(this,"loopId",0);r(this,"_panStart",{x:0,y:0});r(this,"_panDelta",{x:0,y:0});r(this,"_panEnd",{x:0,y:0});r(this,"_paused",!1);r(this,"_isDebug",!1);r(this,"_outputEl");r(this,"mouseWheelForce",1);this.mouseWheelForce=a,t||console.error("camera is undefined"),this.camera=t,this.domElement=e,this.isDamping=!1,this.dampingFactor=.25,this.isZoom=!0,this.zoomSpeed=1,this.isRotate=!0,this.rotateSpeed=1,this.isPan=!0,this.keyPanSpeed=7,this.enableKeys=!0,this.keys={LEFT:"37",UP:"38",RIGHT:"39",BOTTOM:"40",SHIFT:"16"},this.originTarget=H(),this.originPosition=H(),this.originPosition[0]=t.position[0],this.originPosition[1]=t.position[0],this.originPosition[2]=t.position[0];const s=this.camera.position[0],n=this.camera.position[1],o=this.camera.position[2],h=Math.sqrt(s*s+n*n+o*o),u=Math.atan2(this.camera.position[0],this.camera.position[2]),_=Math.acos(at(this.camera.position[1]/h,-1,1));this._spherical={radius:h,theta:u,phi:_},this._bindEvens(),this.setEventHandler(),this.startTick(),this._isDebug=i,i&&(this._outputEl=document.createElement("div"),this._outputEl.setAttribute("style",`
      position: fixed;
      bottom: 24px;
      left: 24px;
      z-index: 999;
      font-family: monospace;
      font-size: 14px;
      user-select: none;
      background: rgba(255, 255, 255, 0.7);
      border-radius: 4px;
      padding: 3px 6px;
    `),document.body.appendChild(this._outputEl))}lookAt([t,e,i]){return nt(this.target,t,e,i),this}setEventHandler(){this.domElement.addEventListener("contextmenu",this._contextMenuHandler,!1),this.domElement.addEventListener("mousedown",this._mouseDownHandler,!1),this.domElement.addEventListener("wheel",this._mouseWheelHandler,!1),this.domElement.addEventListener("touchstart",this._touchStartHandler,!1),this.domElement.addEventListener("touchmove",this._touchMoveHandler,!1),window.addEventListener("keydown",this._onKeyDownHandler,!1),window.addEventListener("keyup",this._onKeyUpHandler,!1)}removeEventHandler(){this.domElement.removeEventListener("contextmenu",this._contextMenuHandler,!1),this.domElement.removeEventListener("mousedown",this._mouseDownHandler,!1),this.domElement.removeEventListener("wheel",this._mouseWheelHandler,!1),this.domElement.removeEventListener("mousemove",this._mouseMoveHandler,!1),window.removeEventListener("mouseup",this._mouseUpHandler,!1),this.domElement.removeEventListener("touchstart",this._touchStartHandler,!1),this.domElement.removeEventListener("touchmove",this._touchMoveHandler,!1),window.removeEventListener("keydown",this._onKeyDownHandler,!1),window.removeEventListener("keydown",this._onKeyUpHandler,!1)}startTick(){this.loopId=requestAnimationFrame(this.tick)}pause(){this._paused=!0}start(){this._paused=!1}tick(){if(!this._paused&&(this.updateDampedAction(),this.updateCamera(),this._isDebug)){const t=Math.round(this.camera.position[0]*100)/100,e=Math.round(this.camera.position[1]*100)/100,i=Math.round(this.camera.position[2]*100)/100;this._outputEl.textContent=`x: ${t} y: ${e} z: ${i}`}this.loopId=requestAnimationFrame(this.tick)}updateDampedAction(){this.target[0]+=this.targetXDampedAction.update(),this.target[1]+=this.targetYDampedAction.update(),this.target[2]+=this.targetZDampedAction.update(),this._spherical.theta+=this.targetThetaDampedAction.update(),this._spherical.phi+=this.targetPhiDampedAction.update(),this._spherical.radius+=this.targetRadiusDampedAction.update()}updateCamera(){const t=this._spherical,e=Math.sin(t.phi)*t.radius;this.camera.position[0]=e*Math.sin(t.theta)+this.target[0],this.camera.position[1]=Math.cos(t.phi)*t.radius+this.target[1],this.camera.position[2]=e*Math.cos(t.theta)+this.target[2],this.camera.lookAt[0]=this.target[0],this.camera.lookAt[1]=this.target[1],this.camera.lookAt[2]=this.target[2]}_bindEvens(){this.tick=this.tick.bind(this),this._contextMenuHandler=this._contextMenuHandler.bind(this),this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._touchStartHandler=this._touchStartHandler.bind(this),this._touchMoveHandler=this._touchMoveHandler.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),this._onKeyUpHandler=this._onKeyUpHandler.bind(this)}_contextMenuHandler(t){!this.isEnabled||t.preventDefault()}_mouseDownHandler(t){!this.isEnabled||(t.button===0?(this.state="rotate",this._rotateStart={x:t.clientX,y:t.clientY}):(this.state="pan",this._panStart={x:t.clientX,y:t.clientY}),this.domElement.addEventListener("mousemove",this._mouseMoveHandler,!1),window.addEventListener("mouseup",this._mouseUpHandler,!1))}_mouseUpHandler(){this.domElement.removeEventListener("mousemove",this._mouseMoveHandler,!1),window.removeEventListener("mouseup",this._mouseUpHandler,!1)}_mouseMoveHandler(t){!this.isEnabled||(this.state==="rotate"?(this._rotateEnd={x:t.clientX,y:t.clientY},this._roatteDelta={x:this._rotateEnd.x-this._rotateStart.x,y:this._rotateEnd.y-this._rotateStart.y},this._updateRotateHandler(),this._rotateStart={x:this._rotateEnd.x,y:this._rotateEnd.y}):this.state==="pan"&&(this._panEnd={x:t.clientX,y:t.clientY},this._panDelta={x:-.5*(this._panEnd.x-this._panStart.x),y:.5*(this._panEnd.y-this._panStart.y)},this._updatePanHandler(),this._panStart={x:this._panEnd.x,y:this._panEnd.y}))}_mouseWheelHandler(t){const e=this.mouseWheelForce;t.deltaY>0?this.targetRadiusDampedAction.addForce(e):this.targetRadiusDampedAction.addForce(-e)}_touchStartHandler(t){let e,i;switch(t.touches.length){case 1:this.state="rotate",this._rotateStart={x:t.touches[0].clientX,y:t.touches[0].clientY};break;case 2:this.state="zoom",e=t.touches[1].clientX-t.touches[0].clientX,i=t.touches[1].clientY-t.touches[0].clientY,this._zoomDistance=Math.sqrt(e*e+i*i);break;case 3:this.state="pan",this._panStart={x:(t.touches[0].clientX+t.touches[1].clientX+t.touches[2].clientX)/3,y:(t.touches[0].clientY+t.touches[1].clientY+t.touches[2].clientY)/3};break}}_touchMoveHandler(t){let e,i,a;switch(t.preventDefault(),t.touches.length){case 1:if(this.state!=="rotate")return;this._rotateEnd={x:t.touches[0].clientX,y:t.touches[0].clientY},this._roatteDelta={x:(this._rotateEnd.x-this._rotateStart.x)*.5,y:(this._rotateEnd.y-this._rotateStart.y)*.5},this._updateRotateHandler(),this._rotateStart={x:this._rotateEnd.x,y:this._rotateEnd.y};break;case 2:if(this.state!=="zoom")return;e=t.touches[1].clientX-t.touches[0].clientX,i=t.touches[1].clientY-t.touches[0].clientY,this._zoomDistanceEnd=Math.sqrt(e*e+i*i),a=this._zoomDistanceEnd-this._zoomDistance,a*=1.5;let s=this._spherical.radius-a;s=at(s,this.minDistance,this.maxDistance),this._zoomDistance=this._zoomDistanceEnd,this._spherical.radius=s;break;case 3:this._panEnd={x:(t.touches[0].clientX+t.touches[1].clientX+t.touches[2].clientX)/3,y:(t.touches[0].clientY+t.touches[1].clientY+t.touches[2].clientY)/3},this._panDelta={x:this._panEnd.x-this._panStart.x,y:this._panEnd.y-this._panStart.y},this._panDelta.x*=-1,this._updatePanHandler(),this._panStart={x:this._panEnd.x,y:this._panEnd.y};break}}_onKeyDownHandler(t){let e=0,i=0;switch(t.key){case this.keys.SHIFT:this._isShiftDown=!0;break;case this.keys.LEFT:e=-10;break;case this.keys.RIGHT:e=10;break;case this.keys.UP:i=10;break;case this.keys.BOTTOM:i=-10;break}this._isShiftDown?(this._roatteDelta={x:-e,y:i},this._updateRotateHandler()):(this._panDelta={x:e,y:i},this._updatePanHandler())}_onKeyUpHandler(t){switch(t.key){case this.keys.SHIFT:this._isShiftDown=!1;break}}_updatePanHandler(){const t=H(),e=H(),i=H();i[0]=this.target[0]-this.camera.position[0],i[1]=this.target[1]-this.camera.position[1],i[2]=this.target[2]-this.camera.position[2],ot(i,i),it(t,i,[0,1,0]),it(e,t,i);const a=Math.max(this._spherical.radius/2e3,.001);this.targetXDampedAction.addForce((t[0]*this._panDelta.x+e[0]*this._panDelta.y)*a),this.targetYDampedAction.addForce((t[1]*this._panDelta.x+e[1]*this._panDelta.y)*a),this.targetZDampedAction.addForce((t[2]*this._panDelta.x+e[2]*this._panDelta.y)*a)}_updateRotateHandler(){this.targetThetaDampedAction.addForce(-this._roatteDelta.x/this.domElement.clientWidth),this.targetPhiDampedAction.addForce(-this._roatteDelta.y/this.domElement.clientHeight)}},Xt=class{constructor(){r(this,"position",B(0,0,0));r(this,"rotation",B(0,0,0));r(this,"scale",B(1,1,1));r(this,"modelMatrix",F());r(this,"shouldUpdate",!0)}copyFromMatrix(t){return ct(this.modelMatrix,t),this.shouldUpdate=!1,this}setPosition(t){return K(this.position,t),this.shouldUpdate=!0,this}setScale(t){return K(this.scale,t),this.shouldUpdate=!0,this}setRotation(t){return K(this.rotation,t),this.shouldUpdate=!0,this}updateModelMatrix(){return wt(this.modelMatrix),gt(this.modelMatrix,this.modelMatrix,this.position),yt(this.modelMatrix,this.modelMatrix,this.rotation[0]),Dt(this.modelMatrix,this.modelMatrix,this.rotation[1]),St(this.modelMatrix,this.modelMatrix,this.rotation[2]),At(this.modelMatrix,this.modelMatrix,this.scale),this.shouldUpdate=!1,this}},Bt=class extends Xt{constructor(t=void 0){super();r(this,"parentNode",null);r(this,"_children",[]);r(this,"_visible",!0);r(this,"worldMatrix",F());r(this,"normalMatrix",F());r(this,"uid",Et(9));r(this,"name");this.name=t}get visible(){return this._visible}set visible(t){this._visible=t}get children(){return this._children}get siblings(){return this.parentNode?this.parentNode._children:[]}get levelIndex(){let t=0,e=this.parentNode;for(;e;)t++,e=e.parentNode;return t}setParent(t=null){if(this.parentNode){const e=this.parentNode._children.indexOf(this);e>=0&&this.parentNode._children.splice(e,1)}return t&&t.addChild(this),this.parentNode=t,this}addChild(t){return this._children.push(t),this}updateWorldMatrix(t=null){this.shouldUpdate&&this.updateModelMatrix(),t?ht(this.worldMatrix,t,this.modelMatrix):ct(this.worldMatrix,this.modelMatrix),dt(this.normalMatrix,this.worldMatrix),Mt(this.normalMatrix,this.normalMatrix);for(let e=0;e<this._children.length;e++)this._children[e].updateWorldMatrix(this.worldMatrix);return this}traverse(t,e=0){t(this,e),e++;for(let i=0;i<this._children.length;i++)this._children[i].traverse(t,e)}findChild(t){if(t(this))return this;let e=null;for(let i=0;i<this._children.length&&!(e=this._children[i].findChild(t));i++);return e}findChildByName(t){if(this.name===t)return this;let e=null;for(let i=0;i<this._children.length&&!(e=this._children[i].findChildByName(t));i++);return e}findParent(t){if(t(this))return this;let e=null,i=this.parentNode;for(;i&&!(e=i.findParent(t));)i=i==null?void 0:i.parentNode;return e}findParentByName(t){if(this.name===t)return this;let e=null,i=this.parentNode;for(;i&&!(e=i.findParentByName(t));)i=i==null?void 0:i.parentNode;return e}render(){if(!!this._visible)for(let t=0;t<this._children.length;t++)this._children[t].render()}},L,$=class extends Bt{constructor(t,e,i,a={},s){super(s);if(U(this,"gl"),U(this,"vao"),U(this,"vertexCount"),z(this,L,new Map),U(this,"boundingBox"),U(this,"program"),this.gl=t,this.vao=t.createVertexArray(),this.program=Ht(t,e,i,a),this.program.__SPECTOR_Metadata={name:s,shaderDefines:a},!this.setUniform($.WORLD_MATRIX_UNIFORM_NAME,{type:t.FLOAT_MAT4}))throw new Error(`Each Drawable is expected to have a mat4 ${$.WORLD_MATRIX_UNIFORM_NAME} implemented in shader`)}setUniform(t,{type:e,value:i}){const a=this.gl;let s;if(s=f(this,L).get(t))s.value=i;else{const n=a.getUniformLocation(this.program,t);if(!n)return console.error(`uniform with name ${t} was not found in the program`),!1;s={type:e,location:n,value:i},f(this,L).set(t,s)}return i!=null&&(a.useProgram(this.program),rt(a,s.type,s.location,i)),!0}updateUniform(t,e){let i;if(i=this.getUniform(t)){i.value=e;const a=this.gl;return a.useProgram(this.program),rt(a,i.type,i.location,e),!0}return!1}getUniform(t){let e;return(e=f(this,L).get(t))?e:(console.error("can't locate uniform with that name"),null)}updateWorldMatrix(t){return super.updateWorldMatrix(t),this.updateUniform($.WORLD_MATRIX_UNIFORM_NAME,this.worldMatrix),this}destroy(){f(this,L).clear();const t=this.gl;t.deleteVertexArray(this.vao),t.deleteProgram(this.program)}},Yt=$;L=new WeakMap;U(Yt,"WORLD_MATRIX_UNIFORM_NAME","u_worldMatrix");var Wt=document.createElement("canvas"),mt=Wt.getContext("webgl2"),R=mt.MAX_TEXTURE_SIZE,V=mt.RGB,G,c,Q=!1,P,C,X,J=class{constructor(){if(z(this,P,[]),z(this,C,[]),z(this,X,document.createElement("div")),Q){const e=document.createElement("style"),i="hwoa-rang-texture-atlas-debug";e.setAttribute("type","text/css");const a=`
        #${i} {
          position: fixed;
          bottom: 1rem;
          right: 1rem;
          transform-origin: 100% 100%;
          width: ${400}px;
          max-height: 100vh;
          overflow: scroll;
        }
        #${i} canvas {
          max-width: 100%;
        }
      `;e.appendChild(document.createTextNode(a)),document.getElementsByTagName("head")[0].appendChild(e),Ot(this,X,document.createElement("div")),f(this,X).setAttribute("id",i),document.body.appendChild(f(this,X))}}static set debugMode(t){Q=t}static get textureSize(){return R}static set textureSize(t){R=t}static set textureFormat(t){V=t}static set gl(t){c=t}static getInstance(){if(!c)throw new Error("You must provide a WebGL2RenderingContext first via setting the TextureAtlas.gl property!");return G||(G=new J),G}pack(t,e,i=1){const a=()=>{const d=document.createElement("canvas");f(this,X).appendChild(d),d.width=R,d.height=R;const v=c.createTexture();c.bindTexture(c.TEXTURE_2D,v),c.texParameterf(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR_MIPMAP_LINEAR),c.texImage2D(c.TEXTURE_2D,0,V,R,R,0,V,c.UNSIGNED_BYTE,null),c.generateMipmap(c.TEXTURE_2D),c.bindTexture(c.TEXTURE_2D,null);const I=new It(d);return f(this,P).push(I),f(this,C).push(v),I};let s=f(this,P)[f(this,P).length-1];s||(s=a());const n=i===1?e:J.scaleDownDrawableByFactor(e,i);s.pack(t,n)||(s=a(),s.pack(t,n));const h=s.uv()[t];for(let d=0;d<h.length;d++)h[d][0]*=R,h[d][1]*=R;const u=f(this,C)[f(this,C).length-1],_=h[0][0],M=h[0][1],p=h[2][0]-h[0][0],l=h[2][1]-h[0][1];return c.bindTexture(c.TEXTURE_2D,u),c.texSubImage2D(c.TEXTURE_2D,0,_,M,p,l,V,c.UNSIGNED_BYTE,n),c.generateMipmap(c.TEXTURE_2D),c.bindTexture(c.TEXTURE_2D,null),this}getUv2(t){let e=-1;for(let i=0;i<f(this,P).length;i++){const s=f(this,P)[i].uv2()[t];if(s){e=i;const n=f(this,C)[e];return[s,n]}}throw new Error("Can't get uvs")}},Vt=J;P=new WeakMap;C=new WeakMap;X=new WeakMap;U(Vt,"scaleDownDrawableByFactor",(t,e)=>{const i=document.createElement("canvas"),a=t instanceof HTMLImageElement?t.naturalWidth:t.width,s=t instanceof HTMLImageElement?t.naturalHeight:t.height;i.width=a/e,i.height=s/e,Q&&console.log(`Scaled ${a}x${s} project image to ${i.width}x${i.height}`);const n=i.getContext("2d");return n.imageSmoothingQuality="high",n.drawImage(t,0,0,a,s,0,0,i.width,i.height),i});var j=class{static linear(t){return t}static quad_In(t){return t*t}static quad_Out(t){return t*(2-t)}static quad_InOut(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}static cubic_In(t){return t*t*t}static cubic_Out(t){return--t*t*t+1}static cubic_InOut(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}static quart_In(t){return t*t*t*t}static quart_Out(t){return 1- --t*t*t*t}static quart_InOut(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}static quint_In(t){return t*t*t*t*t}static quint_Out(t){return--t*t*t*t*t+1}static quint_InOut(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}static sine_In(t){return 1-Math.cos(t*Math.PI/2)}static sine_Out(t){return Math.sin(t*Math.PI/2)}static sine_InOut(t){return .5*(1-Math.cos(Math.PI*t))}static exp_In(t){return t===0?0:Math.pow(1024,t-1)}static exp_Out(t){return t===1?1:1-Math.pow(2,-10*t)}static exp_InOut(t){return t===0||t===1?t:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}static circ_In(t){return 1-Math.sqrt(1-t*t)}static circ_Out(t){return Math.sqrt(1- --t*t)}static circ_InOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static elastic_In(t){return t===0||t===1?t:-Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI)}static elastic_Out(t){return t===0||t===1?t:Math.pow(2,-10*t)*Math.sin((t-.1)*5*Math.PI)+1}static elastic_InOut(t){return t===0||t===1?t:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin((t-1.1)*5*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin((t-1.1)*5*Math.PI)+1)}static back_In(t){return t*t*((1.70158+1)*t-1.70158)}static back_Out(t){return--t*t*((1.70158+1)*t+1.70158)+1}static back_InOut(t){const e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)}static bounce_In(t){return 1-j.bounce_Out(1-t)}static bounce_Out(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounce_InOut(t){return t<.5?j.bounce_In(t*2)*.5:j.bounce_Out(t*2-1)*.5+.5}};export{Jt as C,Yt as D,j as E,Qt as O,jt as P,Bt as S,Gt as a,qt as b,Zt as c,Kt as d};
